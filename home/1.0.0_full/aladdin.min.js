/*!
 * Aladdin.js v0.0.1
 * (c) 2016 Aladdin Group
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.aladdin=e()}(this,function(){"use strict";function t(t){window.__ALADDIN_CALLBACK__=function(){t.callback.apply(t,arguments)},window.__ALADDIN_EVENT_EMIT__=function(){t.emit.apply(t,arguments)}}function e(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return""+t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function n(t,e,n){Object.defineProperty(t,e,{value:n,writable:!1})}function i(t){var e=function(e){e&&this.emit("error",e),t&&"function"==typeof t&&t.apply(null,arguments)}.bind(this);return e.keep=t.keep,e}function o(){this._handlers={},this._subscribers={},this._middlewares=[],this._config={debug:!1,bridgeProtocol:"aladdin"}}function r(t){if(!t||"object"!==("undefined"==typeof t?"undefined":O(t)))return"";var e=[];for(var n in t){var i=t[n];if(Array.isArray(i))for(var o in i)e.push(n+"="+encodeURIComponent(i[o]));else e.push(n+"="+encodeURIComponent(i))}return e.join("&")}function a(t){this._aladdin=t}function s(t){this._aladdin=t}function l(t){this._aladdin=t}function u(t){this._aladdin=t}function c(t){this._aladdin=t}function d(t){for(var e in t)this[e]=t[e]}function h(t){return function(e,n){t(e,new d(n))}}function p(t){this._aladdin=t}function f(t){this._aladdin=t}function y(t){this._aladdin=t}function m(t){this._aladdin=t}function _(t){this._aladdin=t}function b(t){this._aladdin=t}function g(t){this._aladdin=t}function v(t){this._aladdin=t}function w(t){this._aladdin=t}var I=navigator.userAgent.toLocaleLowerCase(),C=I.match(/aladdinhybrid\/\d+\.?\d*\.?\d*/),S=void 0;Array.isArray(C)&&C.length>0&&(S=C[0].split("/")[1]);var k=S,A=/mobile/i.test(I),P=/android/i.test(I),j=!!I.match(/\(i[^;]+;( u;)? cpu.+mac os x/),R=/iphone/i.test(I),L=/ipad/i.test(I),N=!!C,q=!N,x=/micromessenger/i.test(I),E=Object.freeze({hybridVersion:k,isMobile:A,isAndroid:P,isiOS:j,isiPhone:R,isiPad:L,isHybrid:N,isBrowser:q,isWechat:x}),O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};n(o.prototype,"version","0.0.1"),o.prototype.config=function(t){if(t&&"object"===("undefined"==typeof t?"undefined":O(t)))for(var e in t)this._config[e]=t[e];return this},o.prototype.on=function(t,e){return t&&"string"==typeof t&&e&&"function"==typeof e?((this._subscribers[t]||(this._subscribers[t]=[])).push(e),this):this},o.prototype.once=function(t,e){var n=this,i=function i(){n.off(t,i),e.apply(this,arguments)};return i.listener=e,this.on(t,i),this},o.prototype.off=function(t,e){if(!arguments.length){for(t in this._subscribers)delete this._subscribers[t];return this}if(!t)return this;if(!e&&this._subscribers[t])return delete this._subscribers[t],this;for(var n=this._subscribers[t],i=void 0,o=n.length;o--;)if(i=n[o],i===e||i.listener===e){this._subscribers[t].splice(o,1);break}return this},o.prototype.emit=function(){var t=Array.prototype.shift.call(arguments);if(t&&"string"==typeof t){var e=this._subscribers[t];if(e){var n=!0,i=!1,o=void 0;try{for(var r,a=e[Symbol.iterator]();!(n=(r=a.next()).done);n=!0){var s=r.value;s.apply(null,arguments)}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}}}return this},o.prototype.use=function(t){if("function"==typeof t){var e=new t(this),n=e.name||t.name.toLowerCase();if(!n)throw new Error("The component for anonymous function name attribute must be provided");this[n]=e}return this},o.prototype.middleware=function(t){return"function"==typeof t&&this._middlewares.push(t),this},o.prototype._extractHandlers=function(t,e,n,o){for(var r in n){var a=n[r];if("object"===("undefined"==typeof a?"undefined":O(a))&&this._extractHandlers(t,e,a,o),"function"==typeof a){var s=o+"_function_"+t+"_"+e+"_"+r;n[r]=s,this._handlers[s]=i.call(this,a)}}},o.prototype.call=function(t,n){for(var i=arguments.length,o=Array(i>2?i-2:0),r=2;r<i;r++)o[r-2]=arguments[r];var a={component:t,action:n,args:o,callId:e()};this._middlewares.length>0&&this._middlewares.reduce(function(t,e){return e(t)},a),this._extractHandlers(a.component,a.action,a.args,a.callId);var s=this._config.bridgeProtocol+"://"+a.component+"."+a.action+"("+encodeURIComponent(JSON.stringify(a.args))+")";if(this._config.debug&&alert(s),P)prompt(s);else if(j){var l=document.createElement("IFRAME");l.setAttribute("src",s),document.documentElement.appendChild(l),l.parentNode.removeChild(l),l=null}return this},o.prototype.callback=function(){var t=Array.prototype.shift.call(arguments);if(t){var e=this._handlers[t];e&&"function"==typeof e&&(e.apply(null,arguments),e.keep||delete this._handlers[t])}},n(a.prototype,"name","navigator"),a.prototype.setHeader=function(t,e){return t=t||{},this._aladdin.call(this.name,"setHeader",t,e),this},a.prototype.forward=function(t,e){return t=t||{},t.url=t.url||"",t.qs&&(t.url+="?"+r(t.qs)),this._aladdin.call(this.name,"forward",t,e),this},a.prototype.back=function(t,e){return t=t||{},"function"==typeof t&&(e=t,t={}),this._aladdin.call(this.name,"back",t,e),this},a.prototype.login=function(t){return this._aladdin.call(this.name,"login",t),this},n(s.prototype,"name","dialog"),s.prototype.alert=function(t,e){return t=t||{},"string"==typeof t&&(t={message:t,type:"info"}),this._aladdin.call(this.name,"alert",t,e),this},s.prototype.confirm=function(t,e){t=t||{},this._aladdin.call(this.name,"confirm",t,e)},n(l.prototype,"name","loading"),l.prototype.start=function(t,e){return"function"==typeof t&&(e=t,t={}),t=t||{},void 0===t.canCancel&&(t.canCancel=!0),t.message=t.message||"\u52a0\u8f7d\u4e2d...",this._aladdin.call(this.name,"start",t,e),this},l.prototype.stop=function(t){return this._aladdin.call(this.name,"stop",t),this},n(u.prototype,"name","toast"),u.prototype.show=function(t,e){return t=t||{},t.message=t.message||"",t.duration=t.duration||3500,t.position=t.position||"bottom",this._aladdin.call(this.name,"show",t,e),this},u.prototype.hide=function(t){return this._aladdin.call(this.name,"hide",t),this},n(c.prototype,"name","camera"),c.prototype.getPhotos=function(t,e){return t=t||{},this._aladdin.call(this.name,"getPhotos",t,e),this},d.prototype.json=function(){return this.body?JSON.parse(this.body):{}},d.prototype.text=function(){return this.body},d.prototype.header=function(t){if(t=t.toLowerCase(),!this.headers)return"";for(var e in this.headers)if(e.toLowerCase()===t)return this.headers[e];return""},n(p.prototype,"name","http"),p.prototype.request=function(t,e){return"string"==typeof t&&(t={url:t}),t=t||{},t.qs&&"object"===O(t.qs)&&(t.url+="?"+r(t.qs)),t.body&&"object"===O(t.body)&&(t.body=JSON.stringify(t.body)),t.timeout=t.timeout||1e4,t.method=t.method||"get",e=h(e),this._aladdin.call(this.name,"request",t,e),this};var J=["get","post","put","delete","options"];J.forEach(function(t){p.prototype[t]=function(e,n){return"string"==typeof e&&(e={method:t,url:e}),e=e||{},e.method=t,this.request(e,n),this}}),p.prototype.setCookie=function(t,e){return this._aladdin.call(this.name,"setCookie",t,e),this},p.prototype.getCookie=function(t,e,n){return this._aladdin.call(this.name,"getCookie",t,e,n),this},p.prototype.removeCookie=function(t,e,n){return this._aladdin.call(this.name,"removeCookie",t,e,n),this},n(f.prototype,"name","localstorage"),f.prototype.getItem=function(t,e){return this._aladdin.call(this.name,"getItem",t,e),this},f.prototype.setItem=function(t,e,n){var i={};return i.key=t||"",i.value=("object"===("undefined"==typeof e?"undefined":O(e))?JSON.stringify(e):e)||"",this._aladdin.call(this.name,"setItem",i,n),this},f.prototype.removeItem=function(t,e){return this._aladdin.call(this.name,"removeItem",t,e),this},f.prototype.toString=function(t){return this._aladdin.call(this.name,"toString",t),this},f.prototype.toJson=function(t){return this._aladdin.call(this.name,"toString",t),this},f.prototype.clear=function(t){return this._aladdin.call(this.name,"clear",t),this},n(y.prototype,"name","sessionstorage"),y.prototype.getItem=function(t,e){return this._aladdin.call(this.name,"getItem",t,e),this},y.prototype.setItem=function(t,e,n,i){var o={};return o.key=t||"",o.value=("object"===("undefined"==typeof e?"undefined":O(e))?JSON.stringify(e):e)||"",this._aladdin.call(this.name,"setItem",o,i),this},y.prototype.removeItem=function(t,e){return this._aladdin.call(this.name,"removeItem",t,e),this},y.prototype.toString=function(t){return this._aladdin.call(this.name,"toString",t),this},y.prototype.toJson=function(t){return this._aladdin.call(this.name,"toString",t),this},y.prototype.clear=function(t){return this._aladdin.call(this.name,"clear",t),this},n(m.prototype,"name","device"),m.prototype.getInfo=function(t){return this._aladdin.call(this.name,"getInfo",t),this},n(_.prototype,"name","geolocation"),_.prototype.getCurrentPosition=function(t){return this._aladdin.call(this.name,"getCurrentPosition",t),this},n(b.prototype,"name","network"),b.prototype.connectionType=function(t){return this._aladdin.call(this.name,"connectionType",t),this},n(g.prototype,"name","browse"),g.prototype.open=function(t,e){return t=t||{},this._aladdin.call(this.name,"open",t,e),this},n(v.prototype,"name","phone"),v.prototype.call=function(t,e){return t=t||{},this._aladdin.call(this.name,"call",t,e),this},n(w.prototype,"name","recorder"),w.prototype.startRecord=function(t){return this._aladdin.call(this.name,"startRecord",t),this},w.prototype.cancelRecord=function(t){return this._aladdin.call(this.name,"cancelRecord",t),this},w.prototype.stopRecord=function(t){return this._aladdin.call(this.name,"stopRecord",t),this},w.prototype.startPlay=function(t,e){return this._aladdin.call(this.name,"startPlay",t,e),this},w.prototype.stopPlay=function(t){return this._aladdin.call(this.name,"stopPlay",t),this};var H=new o;return H.env=E,H.use(a).use(s).use(u).use(l).use(c).use(p).use(f).use(y).use(m).use(_).use(b).use(g).use(v).use(w),t(H),H});
//# sourceMappingURL=aladdin.min.js.map